(this.webpackJsonpbettactoe=this.webpackJsonpbettactoe||[]).push([[0],{24:function(e,t,n){},25:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n(16),l=n.n(o),r=(n(24),n(12)),s=n(2),i=n(4),b=String(Math.floor(1e5*Math.random())),u=n(17);console.log("connecting to btt server ....");var m=new u.Socket("wss://still-plains-97814.herokuapp.com/socket",{params:{playerId:b}});m.connect();n(25);var j=function(){var e=Object(s.f)(),t=Object(c.useState)(""),n=Object(i.a)(t,2),o=n[0],l=n[1],r=Object(c.useState)(""),u=Object(i.a)(r,2),j=u[0],d=u[1],O=Object(c.useState)(2),h=Object(i.a)(O,2),p=h[0],v=h[1],x=function(e){d(""),v(2),l(e)},f=function(e){d(e.target.value)},g=function(e){var t=parseInt(e.target.value)||2;v(Math.max(2,t))},N=function(t){t.preventDefault();var n={roomName:j,playerCount:p,gameMode:o},a=function(e){var t="",n=e.playerCount,a="btt";switch(e.gameMode){case"default":e.roomName?(t="garuda_matchmaker:".concat(e.roomName,":").concat(a,":").concat(n),e.roomName):t="garuda_matchmaker:".concat(a,":").concat(n);break;case"create":t="garuda_matchmaker:".concat(e.roomName,":").concat(a,":createjoin"),e.roomName;break;case"join":t="garuda_matchmaker:".concat(e.roomName,":").concat(a,":createjoin"),e.roomName,n=-1}var c={roomName:t,playerCount:n,matchId:e.roomName,gameMode:e.gameMode};return m.channel(t,{player_count:c.playerCount,room_name:c.roomName,match_id:c.matchId,mode:c.gameMode})}(n);a.join().receive("ok",(function(e){return console.log("Joined matchmaker",e),"ok"})),a.on("match_maker_event",(function(t){var n;console.log("On match maker event",t),a.leave(),n=t,e.push({pathname:"/game",state:{gameChannelData:n}})})),console.log(n)};return Object(a.jsxs)("div",{className:"menu",children:[Object(a.jsx)("div",{className:"title",children:"Menu"}),Object(a.jsxs)("div",{className:"player-id",children:["PLAYER ID: ",b]}),Object(a.jsxs)("div",{className:"button-container",children:[Object(a.jsx)("button",{className:"btn-mode",onClick:function(){return x("create")},children:"CREATE ROOM"}),Object(a.jsx)("button",{className:"btn-mode",onClick:function(){return x("join")},children:"JOIN ROOM"}),Object(a.jsx)("button",{className:"btn-mode",onClick:function(){return x("default")},children:"RANDOM"})]}),Object(a.jsxs)("div",{className:"mode-input-container",children:["create"===o&&Object(a.jsxs)("form",{onSubmit:N,children:[Object(a.jsxs)("label",{children:["Room name:",Object(a.jsx)("input",{type:"text",placeholder:"Enter room name",value:j,onChange:f})]}),Object(a.jsxs)("label",{children:["Player count:",Object(a.jsx)("input",{type:"text",placeholder:"Enter number",value:p,onChange:g})]}),Object(a.jsx)("input",{type:"submit",value:"Submit"})]}),"join"===o&&Object(a.jsxs)("form",{onSubmit:N,children:[Object(a.jsxs)("label",{children:["Room name:",Object(a.jsx)("input",{type:"text",placeholder:"Enter room name",value:j,onChange:f})]}),Object(a.jsx)("input",{type:"submit",value:"Submit"})]}),"default"===o&&Object(a.jsxs)("form",{onSubmit:N,children:[Object(a.jsxs)("label",{children:["Room name:",Object(a.jsx)("input",{type:"text",placeholder:"Optional",value:j,onChange:f})]}),Object(a.jsxs)("label",{children:["Player count:",Object(a.jsx)("input",{type:"text",placeholder:"Enter number",value:p,onChange:g})]}),Object(a.jsx)("input",{type:"submit",value:"Submit"})]})]})]})},d=function(){return Object(a.jsx)("div",{children:"Lobby"})},O={},h=(n(31),function(e){var t=e.value;return Object(a.jsxs)("button",{className:"square",onClick:function(){var t;e.canMove&&(null===(t=O.gameChannel)||void 0===t||t.push("move",{movedata:{pos:e.pos}}))},children:["0"===t&&"",t===b&&"X",t!==b&&"0"!==t&&"O"]})}),p=(n(32),function(e){for(var t=e.canMove,n=e.board,c=[],o=1;o<=9;o++)c.push(o);return Object(a.jsx)("div",{className:"board",children:c.map((function(e){return Object(a.jsx)(h,{value:n[e-1],pos:e,canMove:t},e)}))})}),v=(n(33),function(e){var t=function(t){e.canBet&&e.onClick(t)};return Object(a.jsxs)("div",{className:"bet-controller",style:{opacity:e.canBet?1:0},children:[Object(a.jsx)("div",{className:"up",onClick:function(){return t(1)},children:"U"}),Object(a.jsx)("div",{className:"down",onClick:function(){return t(-1)},children:"D"})]})}),x=(n(34),function(e){return Object(a.jsx)("div",{className:"player-hud",children:e.lid?Object(a.jsx)("div",{className:"waiting-lig",children:"WAITING"}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"balance",children:e.balance}),Object(a.jsx)("div",{className:"bet",children:e.bet})]})})}),f=(n(35),function(e){var t=e.canBet,n=(e.setBetAmount,e.isOpponentVisible),c=e.opponentData,o=e.playerData,l=e.betController;return Object(a.jsxs)("div",{className:"hud",children:[Object(a.jsx)(x,{balance:o.balance,bet:o.bet}),Object(a.jsx)(v,{canBet:t,onClick:function(e){return l(e)}}),Object(a.jsx)(x,{balance:c.balance,bet:c.bet,lid:!n})]})}),g=(n(36),function(e){var t="";return e.winner===b?("won",t="CONGRATULATIONS! YOU WON"):("lost",t="BETTER LUCK NEXT TIME!"),Object(a.jsx)("div",{className:"result-comp",children:t})}),N=(n(37),function(){var e=Object(s.f)(),t=Object(s.g)();t.state||e.push({pathname:"/"});var n=Object(c.useState)(!1),o=Object(i.a)(n,2),l=o[0],r=o[1],u=Object(c.useState)(!0),j=Object(i.a)(u,2),d=j[0],h=j[1],v=Object(c.useState)(!1),x=Object(i.a)(v,2),N=x[0],C=x[1],k=Object(c.useState)(!1),y=Object(i.a)(k,2),S=y[0],M=y[1],_=Object(c.useState)(0),E=Object(i.a)(_,2),I=E[0],w=E[1],A=Object(c.useState)({bet:0,balance:100}),D=Object(i.a)(A,2),T=D[0],B=D[1],R=Object(c.useState)({bet:0,balance:100}),F=Object(i.a)(R,2),L=F[0],P=F[1],U=Object(c.useState)(["0","0","0","0","0","0","0","0","0"]),J=Object(i.a)(U,2),Y=J[0],V=J[1],W=Object(c.useState)(!1),G=Object(i.a)(W,2),X=G[0],q=G[1],H=Object(c.useState)(""),K=Object(i.a)(H,2),z=K[0],Q=K[1];Object(c.useEffect)((function(){t.state&&(O.gameChannel=function(e){var t=e.match_id;return m.channel("".concat("btt",":").concat(t))}(t.state.gameChannelData),O.gameChannel.join().receive("ok",(function(e){console.log("Joined game channel",e)})),O.gameChannel.on("start_game_event",(function(e){console.log("On start_game_event",e),r(!0)})),O.gameChannel.on("bet_res",(function(e){console.log("bet_res",e),e.p1.id===b?(B({bet:e.p2.bet,balance:e.p2.balance}),P({bet:e.p1.bet,balance:e.p1.balance})):(B({bet:e.p1.bet,balance:e.p1.balance}),P({bet:e.p2.bet,balance:e.p2.balance})),console.log("DSB ~ file: index.tsx ~ line 60 ~ network.gameChannel.on ~ message.turn",e.turn),console.log("DSB ~ file: index.tsx ~ line 61 ~ network.gameChannel.on ~ PLAYER_ID",b),e.turn.id===b?(C(!0),console.log("YOU CAN MOVE")):(C(!1),console.log("YOU CAN NOT MOVE")),M(!0),h(!1)})),O.gameChannel.on("move_res",(function(e){console.log("move_res",e);var t=e.board.map((function(e){return String(e)}));e.p1.id===b?(B({bet:e.p2.bet,balance:e.p2.balance}),P({bet:0,balance:e.p1.balance})):(B({bet:e.p1.bet,balance:e.p1.balance}),P({bet:0,balance:e.p2.balance})),V(t),h(!0),C(!1),M(!1)})),O.gameChannel.on("game_res",(function(e){console.log("game_res",e),Q(e.winner);var t=e.board.map((function(e){return String(e)}));V(t),h(!1),C(!1),q(!0)})))}),[]);return Object(a.jsxs)("div",{className:"game",children:[!l&&Object(a.jsx)("div",{className:"waiting",children:"WAITING..."}),l&&Object(a.jsxs)("div",{className:"start-game",children:[Object(a.jsx)(f,{canBet:d,setBetAmount:w,isOpponentVisible:S,opponentData:T,playerData:L,betController:function(e){return function(e){var t=Math.max(0,Math.min(L.balance,L.balance-e)),n=Math.max(0,Math.min(L.balance,L.bet+e));P({bet:n,balance:t}),w(n)}(e)}}),Object(a.jsx)("div",{className:"bet-confirm",style:{opacity:d?1:0},children:Object(a.jsx)("button",{className:"btn-bet-confirm",onClick:function(){var e;d&&(console.log(I),h(!1),C(!1),null===(e=O.gameChannel)||void 0===e||e.push("bet",{betdata:{playerId:b,bet:I}}))},children:"CONFIRM"})}),Object(a.jsx)(p,{canMove:N,board:Y}),X&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(g,{winner:z}),Object(a.jsx)("button",{className:"btn-go-home",onClick:function(){e.push({pathname:"/"})},children:"NEW MATCH"})]})]})]})}),C=function(e){return Object(a.jsx)(r.a,{children:Object(a.jsxs)(s.c,{children:[Object(a.jsx)(s.a,{exact:!0,path:"/",component:j}),Object(a.jsx)(s.a,{exact:!0,path:"/lobby",component:d}),Object(a.jsx)(s.a,{exact:!0,path:"/game",component:N})]})})},k=(n(38),function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(C,{})})}),y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,l=t.getTTFB;n(e),a(e),c(e),o(e),l(e)}))};l.a.render(Object(a.jsx)(k,{}),document.getElementById("root")),y()}},[[39,1,2]]]);
//# sourceMappingURL=main.54d7737b.chunk.js.map